openapi: 3.0.3
info:
  title: Fake Store API
  description: |
    ä¸€å€‹åŠŸèƒ½å®Œæ•´ã€é«˜æ•ˆèƒ½ä¸”æ˜“æ–¼ä½¿ç”¨çš„æ¨¡æ“¬é›»å­å•†å‹™ API æœå‹™ã€‚
    
    ## æ ¸å¿ƒç‰¹è‰²
    - ğŸš€ **é«˜æ•ˆèƒ½**: Spring Boot WebFlux éŸ¿æ‡‰å¼æ¶æ§‹
    - ğŸ” **å¤šé‡èªè­‰**: æ”¯æ´ OAuth 2.0ã€JWT Token
    - ğŸ’³ **æ”¯ä»˜æ•´åˆ**: Stripe æ²™ç›’ç’°å¢ƒå®Œæ•´æ”¯æŒ
    - ğŸ“Š **æ¨™æº–åŒ–**: åš´æ ¼éµå¾ª Google AIP æ¨™æº–
    - ğŸŒ **å¤šèªè¨€**: éŒ¯èª¤è¨Šæ¯æ”¯æ´ä¸­è‹±æ–‡
    
    ## å¿«é€Ÿé–‹å§‹
    1. [è¨»å†Šé–‹ç™¼è€…å¸³è™Ÿ](#tag/Authentication)
    2. [ç²å– API Token](#operation/createToken)
    3. [æ¢ç´¢ç”¢å“ API](#tag/Products)
    4. [æ¸¬è©¦è³¼ç‰©è»ŠåŠŸèƒ½](#tag/Cart)
    
    ## æ”¯æ´è³‡æº
    - [GitHub Repository](https://github.com/kehao-chen/fake-store-api)
    - [é–‹ç™¼è€…ç¤¾ç¾¤](https://discord.gg/fake-store-api)
    - [å•é¡Œå›å ±](https://github.com/kehao-chen/fake-store-api/issues)
    
  version: "1.0.0"
  contact:
    name: Kehao Chen
    email: kehao.chen@happyhacking.ninja
    url: https://docs.fakestore.happyhacking.ninja
  license:
    name: Apache License 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0
  termsOfService: https://fakestore.happyhacking.ninja/terms

servers:
  - url: https://fakestore.happyhacking.ninja/v1
    description: ç”Ÿç”¢ç’°å¢ƒ API
  - url: https://staging.fakestore.happyhacking.ninja/v1
    description: æ¸¬è©¦ç’°å¢ƒ API
  - url: http://localhost:8080/v1
    description: æœ¬åœ°é–‹ç™¼ç’°å¢ƒ

# æ¨™ç±¤åˆ†çµ„
tags:
  - name: Authentication
    description: èº«ä»½é©—è­‰èˆ‡æˆæ¬Šç®¡ç†
    externalDocs:
      description: èªè­‰æŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/auth
      
  - name: Products
    description: ç”¢å“ç®¡ç†èˆ‡æŸ¥è©¢åŠŸèƒ½
    externalDocs:
      description: ç”¢å“ API æŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/products
      
  - name: Categories
    description: ç”¢å“åˆ†é¡ç®¡ç†
    
  - name: Users
    description: ä½¿ç”¨è€…è³‡æ–™ç®¡ç†
    
  - name: Cart
    description: è³¼ç‰©è»Šæ“ä½œåŠŸèƒ½
    externalDocs:
      description: è³¼ç‰©è»Šä½¿ç”¨æŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/cart
      
  - name: Orders
    description: è¨‚å–®èˆ‡æ”¯ä»˜è™•ç†
    externalDocs:
      description: æ”¯ä»˜æ•´åˆæŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/payments
      
  - name: Admin
    description: ç®¡ç†å“¡å°ˆç”¨åŠŸèƒ½
    
  - name: Events
    description: äº‹ä»¶é©…å‹•æ¶æ§‹å’Œç³»çµ±äº‹ä»¶ç®¡ç†
    externalDocs:
      description: äº‹ä»¶é©…å‹•æ¶æ§‹æŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/events
      
  - name: Webhooks
    description: Webhook è¨‚é–±å’Œäº‹ä»¶é€šçŸ¥ç®¡ç†
    externalDocs:
      description: Webhook æ•´åˆæŒ‡å—
      url: https://docs.fakestore.happyhacking.ninja/webhooks

# è·¯å¾‘å¼•ç”¨
paths:
  # èªè­‰ç›¸é—œ
  /auth/token:
    $ref: './paths/auth.yaml#/auth_token'
  /auth/loginWithGoogle:
    $ref: './paths/auth.yaml#/auth_google'
  /auth/loginWithGithub:
    $ref: './paths/auth.yaml#/auth_github'
    
  # ç”¢å“ç›¸é—œ
  /products:
    $ref: './paths/products.yaml#/products_collection'
  /products/{id}:
    $ref: './paths/products.yaml#/products_item'
  /products:batchGet:
    $ref: './paths/products.yaml#/products_batch_get'
  /products:batchUpdate:
    $ref: './paths/products.yaml#/products_batch_update'
  
  # ç”¢å“äº‹ä»¶æ“ä½œ (ç¬¦åˆ AIP-136 Custom Methods)
  /products/{id}:publish:
    $ref: './paths/events.yaml#/products_publish'
  /products/{id}:unpublish:
    $ref: './paths/events.yaml#/products_unpublish'
    
  # åˆ†é¡ç›¸é—œ
  /categories:
    $ref: './paths/categories.yaml#/categories_collection'
  /categories/{id}:
    $ref: './paths/categories.yaml#/categories_item'
  /categories/{id}/listProducts:
    $ref: './paths/categories.yaml#/categories_list_products'
    
  # ä½¿ç”¨è€…ç›¸é—œ
  /users/me:
    $ref: './paths/users.yaml#/users_me'
  /users/{id}:
    $ref: './paths/users.yaml#/users_item'
    
  # è³¼ç‰©è»Šç›¸é—œ
  /users/me/cart:
    $ref: './paths/users.yaml#/users_me_cart'
  /users/{id}/cart:
    $ref: './paths/users.yaml#/users_cart'
  /users/me/cart/addProduct:
    $ref: './paths/users.yaml#/cart_add_product'
  /users/me/cart/updateProduct:
    $ref: './paths/users.yaml#/cart_update_product'
  /users/me/cart/removeProduct:
    $ref: './paths/users.yaml#/cart_remove_product'
  /users/me/cart/clear:
    $ref: './paths/users.yaml#/cart_clear'
  /users/me/cart/checkout:
    $ref: './paths/users.yaml#/cart_checkout'
    
  # Webhook
  /webhooks/stripe:
    $ref: './paths/webhooks.yaml#/stripe_webhook'
    
  # äº‹ä»¶ç³»çµ± (Event-Driven Architecture)
  /events:
    $ref: './paths/event-queries.yaml#/events_collection'
  /events/{id}:
    $ref: './paths/event-queries.yaml#/events_item'
  /webhooks/subscriptions:
    $ref: './paths/event-queries.yaml#/webhook_subscriptions_collection'
  /webhooks/subscriptions/{id}:
    $ref: './paths/event-queries.yaml#/webhook_subscriptions_item'
    
  # äº‹ä»¶æ“ä½œ (Custom Methods)
  /orders/{id}:updateStatus:
    $ref: './paths/events.yaml#/orders_update_status'
  /users/{id}:sendNotification:
    $ref: './paths/events.yaml#/users_send_notification'

# çµ„ä»¶å¼•ç”¨
components:
  # å®‰å…¨æ–¹æ¡ˆ
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT Bearer Token èªè­‰ã€‚æ ¼å¼ï¼š`Bearer <token>`
        
        ç²å–æ–¹å¼ï¼š
        1. ä½¿ç”¨ `/auth/token` ç«¯é»å–å¾— JWT
        2. æˆ–é€é OAuth 2.0 æµç¨‹ç²å–
        
        ç¯„ä¾‹ï¼š
        ```
        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        ```
        
    BasicAuth:
      type: http
      scheme: basic
      description: |
        HTTP Basic èªè­‰ï¼Œåƒ…ç”¨æ–¼ç‰¹å®šç®¡ç†ç«¯é»
        
    OAuth2:
      type: oauth2
      description: OAuth 2.0 èªè­‰æµç¨‹
      flows:
        authorizationCode:
          authorizationUrl: /auth/loginWithGoogle
          tokenUrl: /auth/token
          scopes:
            read: è®€å–åŸºæœ¬è³‡æ–™æ¬Šé™
            write: å¯«å…¥è³‡æ–™æ¬Šé™
            admin: ç®¡ç†å“¡æ¬Šé™
            
  # è³‡æ–™æ¨¡å‹å¼•ç”¨
  schemas:
    $ref: './components/schemas/index.yaml'
    
  # å›æ‡‰æ¨¡æ¿å¼•ç”¨
  responses:
    $ref: './components/responses/index.yaml'
    
  # åƒæ•¸æ¨¡æ¿å¼•ç”¨
  parameters:
    $ref: './components/parameters/index.yaml'
    
  # ç¯„ä¾‹è³‡æ–™å¼•ç”¨
  examples:
    $ref: './components/examples/index.yaml'

# å…¨åŸŸå®‰å…¨è¦æ±‚
security:
  - BearerAuth: []