# 認證相關資料模型定義
TokenResponse:
  type: object
  required:
    - access_token
    - token_type
    - expires_in
  properties:
    access_token:
      type: string
      description: JWT 存取令牌
      example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
      
    refresh_token:
      type: string
      nullable: true
      description: 刷新令牌
      example: "refresh_token_abc123"
      
    token_type:
      type: string
      enum: ["Bearer"]
      description: 令牌類型
      example: "Bearer"
      
    expires_in:
      type: integer
      minimum: 1
      description: 存取令牌過期時間 (秒)
      example: 900
      
    scope:
      type: string
      nullable: true
      description: 授權範圍
      example: "read write"
      
    user_id:
      type: string
      pattern: '^user_[a-zA-Z0-9]+$'
      description: 使用者 ID
      example: "user_123abc"
      
  example:
    access_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    refresh_token: "refresh_token_abc123"
    token_type: "Bearer"
    expires_in: 900
    scope: "read write"
    user_id: "user_123abc"

EmailLoginRequest:
  type: object
  required:
    - grant_type
    - email
    - password
  properties:
    grant_type:
      type: string
      enum: ["password"]
      description: 授權類型
      example: "password"
      
    email:
      type: string
      format: email
      description: 使用者電子信箱
      example: "user@example.com"
      
    password:
      type: string
      minLength: 8
      maxLength: 128
      description: 使用者密碼
      example: "securePassword123"
      
    scope:
      type: string
      nullable: true
      description: 請求的權限範圍
      example: "read write"
      
  example:
    grant_type: "password"
    email: "user@example.com"
    password: "securePassword123"
    scope: "read write"

OAuthTokenRequest:
  type: object
  required:
    - grant_type
    - code
    - code_verifier
  properties:
    grant_type:
      type: string
      enum: ["authorization_code"]
      description: 授權類型
      example: "authorization_code"
      
    code:
      type: string
      description: OAuth 授權碼
      example: "oauth_authorization_code"
      
    code_verifier:
      type: string
      minLength: 43
      maxLength: 128
      pattern: '^[A-Za-z0-9\-._~]+$'
      description: PKCE 代碼驗證器
      example: "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk"
      
    redirect_uri:
      type: string
      format: uri
      nullable: true
      description: 重定向 URI (必須與授權請求一致)
      example: "https://yourapp.com/callback"
      
  example:
    grant_type: "authorization_code"
    code: "oauth_authorization_code"
    code_verifier: "dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk"
    redirect_uri: "https://yourapp.com/callback"

RefreshTokenRequest:
  type: object
  required:
    - grant_type
    - refresh_token
  properties:
    grant_type:
      type: string
      enum: ["refresh_token"]
      description: 授權類型
      example: "refresh_token"
      
    refresh_token:
      type: string
      description: 刷新令牌
      example: "refresh_token_abc123"
      
    scope:
      type: string
      nullable: true
      description: 請求的權限範圍 (可選，不可超過原始範圍)
      example: "read"
      
  example:
    grant_type: "refresh_token"
    refresh_token: "refresh_token_abc123"
    scope: "read"

# API Key 模型
ApiKey:
  type: object
  required: [id, name, prefix, created_at]
  properties:
    id:
      type: string
      pattern: '^key_[a-zA-Z0-9]+$'
      description: API Key 識別碼
      example: "key_abc123"
    name:
      type: string
      maxLength: 100
      description: 金鑰顯示名稱
      example: "my-local-dev-key"
    prefix:
      type: string
      description: 用於快速識別的金鑰前綴（完整 key 僅在建立時回傳）
      example: "sk_live_"
    last_used_at:
      type: string
      format: date-time
      nullable: true
      description: 最近使用時間
    created_at:
      type: string
      format: date-time
      description: 建立時間
      example: "2025-08-22T10:30:00Z"

CreateApiKeyRequest:
  type: object
  properties:
    name:
      type: string
      maxLength: 100
      description: 金鑰顯示名稱
      example: "my-local-dev-key"

CreateApiKeyResponse:
  type: object
  required: [api_key, key]
  properties:
    api_key:
      $ref: '#/ApiKey'
    key:
      type: string
      description: 完整 API Key 值（僅建立時回傳，請妥善保存）
      example: "sk_test_1234567890abcdef"
